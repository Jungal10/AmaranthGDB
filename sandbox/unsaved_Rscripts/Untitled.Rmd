---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 


#sites: 332578538

```{r, results="hide", echo =FALSE, eval =FALSE}
saf2cruenuts_AF<-fread('/Users/josedias/mount/scratch/jgoncal1/outputs/cruentus_ancRef_doSaf2_minimal.mafs.gz') 


saf2cruentus <- saf2cruenuts_AF %>%
  mutate(mAF=case_when(unknownEM > 0.5 ~ 1-unknownEM,
                      TRUE~ unknownEM))

```


```{r, results="hide", echo =FALSE, eval =FALSE}
quitenis_AF<-fread('/Users/josedias/mount/scratch/jgoncal1/outputs/step1_cruentus_ancRef.mafs.gz') 


MAF_quitensis <- quitenis_AF %>%
  mutate(mAF=case_when(unknownEM > 0.5 ~ 1-unknownEM,
                      TRUE~ unknownEM))

```


```{r}
scipen=999

sfs_quitensis<- scan('/Users/josedias/mount/scratch/jgoncal1/outputs/final_quitensis.sfs')
 sfs_quitensis<- sfs_quitensis[-c(1,length(sfs_quitensis))]
 barplot(sfs_quitensis, names=1:length(sfs_quitensis), main = 'sfs_quitensis')

```






```{r}
scipen=999

sfs_saf2_cruentus<- scan('/Users/josedias/mount/scratch/jgoncal1/outputs/cruentus_ancRef_doSaf2_minimal.sfs')
sfs_saf2_cruentus[2:3]
 sfs_saf2_cruentus<- sfs_saf2_cruentus[-c(1,length(sfs_saf2_cruentus))]
 barplot(sfs_saf2_cruentus, names=1:length(sfs_saf2_cruentus), main = 'sfs_cruentus')

```



#### Folded SFS plot generated from minor allele frequencies (11 bins)

```{r}

ggplot(MAF_quitensis, aes(mAF))+
geom_histogram(bins=11, color='white')+ 
ggtitle("quitensis_SFS") +
xlab("Minor allele frequency")  +
nice_layout
```



#### Folded SFS plot generated from minor allele frequencies (11 bins)

```{r}
MAF_quitensis %>%
filter(mAF>1/12) %>%
ggplot(aes(mAF))+
geom_histogram(bins=11, color='white')+ 
ggtitle("quitensis_SFS, maf >1/12") +
xlab("Minor allele frequency")  +
nice_layout
```



```{r}
nrow(saf2cruentus)

saf2cruentus %>%
filter(mAF>1/24) %>%
  nrow()
```





Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

